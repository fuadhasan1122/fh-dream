<div class="container section-{{ section.id }}-padding">
    <div class="browse-collection">
        <div class="browse-header">
            <h2>{{ section.settings.title }}</h2>
            <p>{{ section.settings.paragraph }}</p>
        </div>

        <div class="collection-grid">
            {% for block in section.blocks %}
                 {%- assign collection = collections[block.settings.collection_handle] -%}
                 
                 <a href="{{ collection.url | default: '#' }}" class="collection-card child-col-{{ forloop.index }}" {{ block.shopify_attributes }}>
                    <div class="image-wrapper">
                        {%- if block.settings.col_img != blank -%}
                            <img src="{{ block.settings.col_img | img_url: 'master' }}"alt="{{ collection.title | default: 'Collection Image' }}" loading="lazy">
                        {%- elsif collection.image != blank -%}
                            <img src="{{ collection.image | img_url: 'master' }}" 
                                 alt="{{ collection.title }}" 
                                 loading="lazy">
                        {%- else -%}
                            {{ 'collection-' | append: forloop.index | placeholder_svg_tag: 'placeholder-svg' }}
                        {%- endif -%}
                    </div>
                    
                    <div class="card-overlay">
                        <h3>{{ collection.title | default: "New Collection" }}</h3>
                    </div>
                 </a>
            {% endfor %}
        </div>
    </div>
</div>

{% style %}
    .section-{{ section.id }}-padding {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: 40px;
    }

    .browse-header {
        text-align: center;
        margin-bottom: 2rem;
    }

    .browse-header h2 {
        margin: 0 0 0.5rem 0;
        font-size: 2.5rem;
    }

    .browse-header p {
        margin: 0;
        color: #666;
    }

    .collection-grid {
        display: grid;
        gap: 15px;
        /* Standard 4-column layout */
        grid-template-areas: 
            "one one one two"
            "one one one three";
        min-height: 500px;
    }

    .collection-card {
        position: relative;
        text-decoration: none;
        overflow: hidden;
        display: block;
        border-radius: 4px;
    }

    /* Assigning Grid Areas */
    .child-col-1 { grid-area: one; }
    .child-col-2 { grid-area: two; }
    .child-col-3 { grid-area: three; }

    .image-wrapper {
        width: 100%;
        height: 100%;
        position: relative;
    }

    .collection-card img, 
    .collection-card svg {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }

    .collection-card:hover img {
        transform: scale(1.05);
    }

    .card-overlay {
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(to top, rgba(0,0,0,0.5), transparent);
        display: flex;
        align-items: flex-end;
        padding: 20px;
        z-index: 2;
    }

    .card-overlay h3 {
        color: #fff;
        margin: 0;
        font-size: 1.5rem;
    }

    /* Responsive: Stack vertically on mobile */
    @media (max-width: 768px) {
        .collection-grid {
            grid-template-areas: 
                "one"
                "two"
                "three";
            grid-template-columns: 1fr;
        }
        
        .collection-card {
            min-height: 250px;
        }
    }
{% endstyle %}

{% schema %}
{
  "name": "Browse Collection",
  "max_blocks": 3,
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Browse The Range"
    },
    {
      "type": "text",
      "id": "paragraph",
      "label": "Content",
      "default": "Elegant, Timeless & functional products"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "default": 20
    }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        {
          "type": "collection",
          "id": "collection_handle",
          "label": "Choose Collection"
        },
        {
          "type": "image_picker",
          "id": "col_img",
          "label": "Custom Image (Optional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Browse collections",
      "blocks": [
        { "type": "collection" },
        { "type": "collection" },
        { "type": "collection" }
      ]
    }
  ]
}
{% endschema %}